{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useRef, useState, useEffect } from \"react\";\nimport axios from 'axios';\nimport CategoryList from './category.list.component';\nimport OnLoadComponent from '../onload.component';\nimport GetItem from '../localStorage/getItem';\nimport { Router } from \"next/router\";\n\nvar AddProduct = function AddProduct(props) {\n  var _usrData$phone3, _usrData$phone4, _usrData$phone5, _usrData$phone6;\n\n  var imgRef = useRef(null);\n\n  var _useState = useState(GetItem('user')),\n      cookies = _useState[0],\n      setCookie = _useState[1];\n\n  var _useState2 = useState('/img/img-not-found.png'),\n      imageProd = _useState2[0],\n      setImageProd = _useState2[1];\n\n  var _useState3 = useState({}),\n      imgUpload = _useState3[0],\n      setImgUpload = _useState3[1];\n\n  var _useState4 = useState(''),\n      title = _useState4[0],\n      setTitle = _useState4[1];\n\n  var _useState5 = useState('d-none'),\n      titleSuccessProduct = _useState5[0],\n      setTitleSuccessProduct = _useState5[1];\n\n  var _useState6 = useState(''),\n      description = _useState6[0],\n      setDescription = _useState6[1];\n\n  var _useState7 = useState(''),\n      amount = _useState7[0],\n      setAmount = _useState7[1];\n\n  var _useState8 = useState(''),\n      amountSale = _useState8[0],\n      setAmountSale = _useState8[1];\n\n  var _useState9 = useState(''),\n      discount = _useState9[0],\n      setDiscount = _useState9[1];\n\n  var _useState10 = useState('true'),\n      shipping = _useState10[0],\n      setShipping = _useState10[1];\n\n  var _useState11 = useState(''),\n      location = _useState11[0],\n      setLocation = _useState11[1];\n\n  var _useState12 = useState(''),\n      type = _useState12[0],\n      setType = _useState12[1];\n\n  var _useState13 = useState(''),\n      contact = _useState13[0],\n      setContact = _useState13[1];\n\n  var _useState14 = useState(''),\n      CBU = _useState14[0],\n      setCBU = _useState14[1];\n\n  var _useState15 = useState(''),\n      subCategory = _useState15[0],\n      setSubCategory = _useState15[1];\n\n  var _useState16 = useState(''),\n      payment = _useState16[0],\n      setPayment = _useState16[1];\n\n  var _useState17 = useState(false),\n      onLoadAdd = _useState17[0],\n      setOnLoadAdd = _useState17[1];\n\n  var _useState18 = useState('d-block'),\n      hiddenBtn = _useState18[0],\n      setHiddenBtn = _useState18[1];\n\n  var _useState19 = useState({}),\n      usrData = _useState19[0],\n      setUsrData = _useState19[1];\n\n  var HandlerFindUser = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(idUser) {\n      var getUser, resUser;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return axios.get(\"\".concat(process.env.API_PATH, \"/v1/user/\").concat(idUser));\n\n            case 2:\n              getUser = _context.sent;\n              _context.next = 5;\n              return getUser === null || getUser === void 0 ? void 0 : getUser.data;\n\n            case 5:\n              resUser = _context.sent;\n              return _context.abrupt(\"return\", resUser);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function HandlerFindUser(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    var _cookies$user;\n\n    HandlerFindUser(cookies === null || cookies === void 0 ? void 0 : (_cookies$user = cookies.user) === null || _cookies$user === void 0 ? void 0 : _cookies$user.id).then(function (r) {\n      return setUsrData(r);\n    })[\"catch\"](function (er) {\n      return console.error(er);\n    });\n  }, [Router]);\n\n  var handleAddProduct = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.t0 = fetch;\n              _context3.t1 = \"\".concat(process.env.API_PATH, \"/v1/auth\");\n              _context3.t2 = JSON;\n              _context3.next = 5;\n              return cookies.user.token;\n\n            case 5:\n              _context3.t3 = _context3.sent;\n              _context3.t4 = {\n                token: _context3.t3\n              };\n              _context3.t5 = _context3.t2.stringify.call(_context3.t2, _context3.t4);\n              _context3.t6 = {\n                'Content-Type': 'application/json',\n                'Access-Control-Allow-Origin': '*',\n                'token': cookies.user.token\n              };\n              _context3.t7 = {\n                body: _context3.t5,\n                method: 'POST',\n                headers: _context3.t6\n              };\n              _context3.next = 12;\n              return (0, _context3.t0)(_context3.t1, _context3.t7).then(function (res) {\n                return res.json();\n              }).then( /*#__PURE__*/function () {\n                var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(success) {\n                  var _usrData$phone, _usrData$phone2, _cookies$user2, frmData;\n\n                  return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                      switch (_context2.prev = _context2.next) {\n                        case 0:\n                          if (success.auth) {\n                            frmData = new FormData();\n                            frmData.append('img', imgRef.current.files[0]);\n                            frmData.append('title', \"\".concat(title));\n                            frmData.append('description', \"\".concat(description));\n                            frmData.append('amount', amount);\n                            frmData.append('amount_sale', amountSale || 'http://');\n                            frmData.append('discount', discount);\n                            frmData.append('payment', payment || 'http://');\n                            frmData.append('shipping', shipping);\n                            frmData.append('CBU', CBU);\n                            frmData.append('contact_business', contact || \"\".concat(usrData === null || usrData === void 0 ? void 0 : (_usrData$phone = usrData.phone) === null || _usrData$phone === void 0 ? void 0 : _usrData$phone.area_code).concat(usrData === null || usrData === void 0 ? void 0 : (_usrData$phone2 = usrData.phone) === null || _usrData$phone2 === void 0 ? void 0 : _usrData$phone2.number));\n                            frmData.append('business', cookies === null || cookies === void 0 ? void 0 : (_cookies$user2 = cookies.user) === null || _cookies$user2 === void 0 ? void 0 : _cookies$user2.business);\n                            frmData.append('location', location);\n                            frmData.append('type', type);\n                            frmData.append('subcategory', subCategory);\n                            axios.post(\"\".concat(process.env.API_PATH, \"/v1/product\"), frmData, {\n                              headers: {\n                                'Content-Type': 'multipart/form-data',\n                                'Access-Control-Allow-Origin': '*',\n                                'token': cookies.user.token\n                              }\n                            }).then(function (productAdd) {\n                              if (productAdd.data.insert) {\n                                setOnLoadAdd(false);\n                                setHiddenBtn('d-block');\n                                setTitleSuccessProduct('d-block');\n                                setTimeout(function () {\n                                  setTitleSuccessProduct('d-none');\n                                }, 2500);\n                              } else {\n                                console.log('error: product is not added');\n                              }\n                            })[\"catch\"](function (errAdd) {\n                              return console.error(errAdd);\n                            });\n                          }\n\n                        case 1:\n                        case \"end\":\n                          return _context2.stop();\n                      }\n                    }\n                  }, _callee2);\n                }));\n\n                return function (_x2) {\n                  return _ref3.apply(this, arguments);\n                };\n              }())[\"catch\"](function (err) {\n                return console.error(err);\n              });\n\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleAddProduct() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handlerSubmit = function handlerSubmit(e) {\n    e.preventDefault();\n    setOnLoadAdd(true);\n    setHiddenBtn('d-none');\n    handleAddProduct();\n    setLocation('');\n    setDescription('');\n    setAmount('');\n    setAmountSale('');\n    setDiscount('');\n    setContact('');\n    setCBU('');\n    setTitle('');\n    setType('');\n    setImageProd('');\n    setPayment('');\n  };\n\n  var handleInputTitle = function handleInputTitle(e) {\n    return setTitle(\"\".concat(e.target.value));\n  },\n      handleInputDescription = function handleInputDescription(e) {\n    return setDescription(\"\".concat(e.target.value));\n  },\n      handleInputAmount = function handleInputAmount(e) {\n    return setAmount(e.target.value);\n  },\n      handleInputAmountSale = function handleInputAmountSale(e) {\n    return setAmountSale(e.target.value);\n  },\n      handleInputDiscount = function handleInputDiscount(e) {\n    return setDiscount(e.target.value);\n  },\n      handleInputLocation = function handleInputLocation(e) {\n    return setLocation(e.target.value);\n  },\n      handleInputType = function handleInputType(e) {\n    return setType(e.target.value);\n  },\n      handleInputSubCategory = function handleInputSubCategory(e) {\n    return setSubCategory(e.target.value);\n  },\n      handleInputPayment = function handleInputPayment(e) {\n    return setPayment(e.target.value);\n  },\n      handleInputCBU = function handleInputCBU(e) {\n    return setCBU(e.target.value);\n  },\n      handleInputContact = function handleInputContact(e) {\n    return setContact(e.target.value);\n  },\n      imgPreviewProd = function imgPreviewProd(e) {\n    var reader = new FileReader();\n\n    reader.onloadend = function () {\n      setImageProd(reader.result);\n    };\n\n    if (e.target.files[0]) {\n      setImgUpload(e.target.files[0]);\n      reader.readAsDataURL(e.target.files[0]);\n    } else {\n      setImageProd('');\n    }\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"article\", {\n    className: \"col-12 col-sm-12 col-lg-6 col-xl-6 content-frm-login frm-create-influencer\"\n  }, __jsx(\"article\", {\n    className: \"col-12\"\n  }, __jsx(\"h4\", {\n    className: \"d-inline-flex\"\n  }, \"Agregar un producto\"), __jsx(\"svg\", {\n    width: \"1em\",\n    height: \"1em\",\n    viewBox: \"0 0 16 16\",\n    className: \"ml-2 bi bi-plus-circle\",\n    fill: \"currentColor\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, __jsx(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"\n  }), __jsx(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"\n  })), __jsx(\"hr\", null), __jsx(\"form\", {\n    onSubmit: handlerSubmit\n  }, __jsx(\"article\", {\n    className: \"row p-0\"\n  }, __jsx(\"article\", {\n    className: \"col-12 col-sm-12 col-lg-6 col-xl-6 ml-auto mr-auto p-0\"\n  }, __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"T\\xEDtulo \", __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"textarea\", {\n    required: true,\n    onChange: handleInputTitle,\n    className: \"d-block txt-title-frm\",\n    value: title,\n    placeholder: \"T\\xEDtulo\"\n  }), __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"Precio \", __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"input\", {\n    required: true,\n    onChange: handleInputAmount,\n    className: \"d-block\",\n    type: \"text\",\n    placeholder: \"Precio\",\n    value: amount\n  }), __jsx(\"hr\", null), __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"Seleccionar una im\\xE1gen \", __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"label\", {\n    htmlFor: \"btn-img-file\",\n    className: \"btn-label-file col-7 btn\"\n  }, \"Seleccionar im\\xE1gen\"), __jsx(\"input\", {\n    ref: imgRef,\n    required: true,\n    id: \"btn-img-file\",\n    type: \"file\",\n    onChange: imgPreviewProd,\n    className: \"d-none mt-2 mb-2\",\n    accept: \"image/*\"\n  }), __jsx(\"article\", {\n    style: {\n      backgroundImage: \"url('\".concat(imageProd, \"')\")\n    },\n    className: \"img-preview-prod\"\n  }), __jsx(\"hr\", null), __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"Categor\\xEDa \", __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"select\", {\n    required: true,\n    onChange: handleInputType,\n    className: \"d-block bg-light\"\n  }, __jsx(\"option\", {\n    key: \"-1\",\n    value: \"null\"\n  }, \"-- Seleccionar una opci\\xF3n --\"), CategoryList.map(function (element, i) {\n    return __jsx(\"option\", {\n      key: i,\n      value: element.category\n    }, element.title);\n  })), type === 'indumentarias' && __jsx(React.Fragment, null, __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"Sub-categor\\xEDa \", __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"select\", {\n    required: true,\n    onChange: handleInputSubCategory,\n    className: \"d-block bg-light\"\n  }, __jsx(\"option\", {\n    value: \"null\"\n  }, \"No\"), __jsx(\"option\", {\n    value: \"hombre\"\n  }, \"Hombre\"), __jsx(\"option\", {\n    value: \"mujer\"\n  }, \"Mujer\"), __jsx(\"option\", {\n    value: \"ni\\xF1os\"\n  }, \"Ni\\xF1os\"), __jsx(\"option\", {\n    value: \"invierno\"\n  }, \"Invierno\"), __jsx(\"option\", {\n    value: \"verano\"\n  }, \"Verano\")))), __jsx(\"article\", {\n    className: \"col-12 col-sm-12 col-lg-4 col-xl-4 ml-auto mr-auto p-0\"\n  }, __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"Descuento \", __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"input\", {\n    required: true,\n    onChange: handleInputDiscount,\n    className: \"d-block\",\n    type: \"text\",\n    placeholder: \"Descuento\",\n    value: discount\n  }), __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"CBU de ingresos \", __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"input\", {\n    onChange: handleInputCBU,\n    type: \"text\",\n    name: \"CBU\",\n    className: \"d-block\",\n    placeholder: \"CBU de ingresos\"\n  }), __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"Tel\\xE9fono \", (usrData === null || usrData === void 0 ? void 0 : usrData.phone) && \"(\".concat(usrData === null || usrData === void 0 ? void 0 : (_usrData$phone3 = usrData.phone) === null || _usrData$phone3 === void 0 ? void 0 : _usrData$phone3.area_code).concat(usrData === null || usrData === void 0 ? void 0 : (_usrData$phone4 = usrData.phone) === null || _usrData$phone4 === void 0 ? void 0 : _usrData$phone4.number, \")\"), __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"input\", {\n    onChange: handleInputContact,\n    type: \"text\",\n    name: \"contact_business\",\n    className: \"d-block\",\n    placeholder: \"\".concat(usrData === null || usrData === void 0 ? void 0 : (_usrData$phone5 = usrData.phone) === null || _usrData$phone5 === void 0 ? void 0 : _usrData$phone5.area_code).concat(usrData === null || usrData === void 0 ? void 0 : (_usrData$phone6 = usrData.phone) === null || _usrData$phone6 === void 0 ? void 0 : _usrData$phone6.number)\n  }), __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"Localidad \", __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"input\", {\n    required: true,\n    onChange: handleInputLocation,\n    className: \"d-block\",\n    type: \"text\",\n    placeholder: \"Localidad\",\n    value: location\n  })), __jsx(\"article\", {\n    className: \"col-12 ml-auto mr-auto p-0\"\n  }, __jsx(\"small\", {\n    className: \"p-2 m-0\"\n  }, \"Descripci\\xF3n \", __jsx(\"span\", {\n    className: \"text-danger\"\n  }, \"*\")), __jsx(\"textarea\", {\n    required: true,\n    onChange: handleInputDescription,\n    className: \"d-block\",\n    value: description,\n    placeholder: \"Descripci\\xF3n\"\n  }), __jsx(\"input\", {\n    type: \"submit\",\n    value: \"Agregar\",\n    className: \"form-control d-block btn\"\n  }), __jsx(\"p\", {\n    className: \"bg-success text-light add-success \".concat(titleSuccessProduct)\n  }, \"Se ha insertado con \\xE9xito!\")))))), __jsx(OnLoadComponent.OnloadProductComponent, {\n    status: onLoadAdd\n  }));\n};\n\nexport default AddProduct;","map":null,"metadata":{},"sourceType":"module"}