{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport { useCookies } from 'react-cookie';\nimport { useRouter } from \"next/router\";\nimport CurrencyFormat from 'react-currency-format';\nimport SendTransaction from './send.transaction.component';\nimport RemoveProduct from '../management/remove.product.component';\nimport EditProduct from '../management/edit.product.component';\nimport { Image, Video, Transformation, CloudinaryContext } from 'cloudinary-react';\nimport { useRef } from 'react';\n\nvar Product = function Product(prop) {\n  var Router = useRouter();\n  var id = Router.query.id;\n  var imgContent = useRef(null);\n\n  var _useState = useState(''),\n      credential = _useState[0],\n      setCredential = _useState[1];\n\n  var _useState2 = useState(''),\n      imgContentState = _useState2[0],\n      setImgContentState = _useState2[1];\n\n  var _useCookies = useCookies(['user']),\n      _useCookies2 = _slicedToArray(_useCookies, 2),\n      cookies = _useCookies2[0],\n      setCookie = _useCookies2[1];\n\n  var _useState3 = useState([]),\n      product = _useState3[0],\n      setProduct = _useState3[1];\n\n  var _useState4 = useState('d-none'),\n      influencerTokenExist = _useState4[0],\n      setInfluencerTokenExist = _useState4[1];\n\n  var _useState5 = useState(''),\n      userIsNotReffered = _useState5[0],\n      setUserIsNotReffered = _useState5[1];\n\n  var _useState6 = useState(''),\n      influencerTokenNoExist = _useState6[0],\n      setInfluencerTokenNoExist = _useState6[1];\n\n  var _useState7 = useState('accept-payment-close'),\n      acceptPaymentSwitch = _useState7[0],\n      setAcceptPaymentSwitch = _useState7[1];\n\n  var _useState8 = useState('Compralo en un instante!'),\n      valueBtnSwitchPayment = _useState8[0],\n      setValueBtnSwitchPayment = _useState8[1];\n\n  var _useState9 = useState('d-none'),\n      switchNextStepPayment = _useState9[0],\n      setSwitchNextStepPayment = _useState9[1];\n\n  useEffect(function () {\n    if (cookies.user && cookies.user.rol !== 'master') {\n      setCredential('false');\n    } else if (!cookies.user) {\n      setCredential('false');\n    }\n\n    if (cookies.user && cookies.user.rol === 'master') {\n      setCredential('true');\n    }\n\n    var handlerTokenExist = function handlerTokenExist() {\n      if (cookies.user && cookies.user.discount_token) {\n        setInfluencerTokenExist('');\n        setInfluencerTokenNoExist('d-none');\n        setUserIsNotReffered('');\n      } else {\n        setInfluencerTokenExist('d-none');\n        setInfluencerTokenNoExist('');\n        setUserIsNotReffered('d-none');\n      } //kfuiqqbr-blets\n\n    };\n\n    handlerTokenExist();\n  }, null);\n\n  var handlerAcceptPaymentSwitch = function handlerAcceptPaymentSwitch(e) {\n    if (cookies.user) {\n      if (acceptPaymentSwitch === 'accept-payment-close') {\n        e.target.classList.toggle('btn-danger');\n        e.target.classList.remove('btn-buy-now');\n        setValueBtnSwitchPayment('Cerrar');\n        setAcceptPaymentSwitch('');\n      } else {\n        e.target.classList.toggle('btn-danger');\n        e.target.classList.add('btn-buy-now');\n        setValueBtnSwitchPayment('Pagar con Mercado Pago!');\n        setAcceptPaymentSwitch('accept-payment-close');\n      }\n    } else {\n      window.location = '/iniciar-sesion';\n    }\n  };\n\n  var handlerTransaction = function handlerTransaction() {\n    var objectTransaction = {\n      id_product: product._id,\n      token_influencer: cookies.user.discount_token ? cookies.user.discount_token : 'organic',\n      id_client: cookies.user.id,\n      status_transaction: 'pending'\n    };\n    SendTransaction(objectTransaction).then(function (success) {\n      setSwitchNextStepPayment('d-block');\n    })[\"catch\"](function (err) {\n      return console.error(err);\n    });\n  };\n\n  useEffect(function () {\n    var getAllProduct = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var fetchAll, dataFetch;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(\"\".concat(process.env.API_PATH, \"/v1/product/\").concat(id), {\n                  headers: {\n                    'Content-Type': 'application/json',\n                    'Access-Control-Allow-Origin': '*'\n                  }\n                });\n\n              case 2:\n                fetchAll = _context.sent;\n                _context.next = 5;\n                return fetchAll.json();\n\n              case 5:\n                dataFetch = _context.sent;\n                setProduct(dataFetch);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function getAllProduct() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    setImgContentState(imgContent.current.offsetWidth);\n    getAllProduct();\n  }, [id]);\n  return __jsx(React.Fragment, null, __jsx(\"section\", {\n    className: \"row section-product\"\n  }, __jsx(\"article\", {\n    className: \"col-12 col-sm-12 col-lg-8 col-xl-8\"\n  }, __jsx(\"article\", {\n    ref: imgContent,\n    className: \"col-12 content-img-prod-open\"\n  }, credential === 'true' ? __jsx(RemoveProduct, {\n    product: product\n  }) : false, credential === 'true' ? __jsx(EditProduct, {\n    product: product\n  }) : false, __jsx(CloudinaryContext, {\n    cloudName: \"blets\"\n  }, __jsx(Image, {\n    cloudName: \"blets\",\n    publicId: product.img,\n    alt: product.title\n  }, __jsx(Transformation, {\n    width: imgContentState - 50,\n    crop: \"scale\"\n  })))), __jsx(\"article\", {\n    className: \"col-12\"\n  }, __jsx(\"h2\", null, \"Descripci\\xF3n\"), __jsx(\"hr\", null), __jsx(\"ul\", {\n    type: \"none\"\n  }, __jsx(\"li\", null, \"- Categor\\xEDa: \", __jsx(\"span\", {\n    className: \"text-dark\"\n  }, __jsx(\"strong\", null, product.type)), __jsx(\"br\", null)), __jsx(\"li\", null, \"- Nombre del negocio: \", __jsx(\"span\", {\n    className: \"text-dark\"\n  }, __jsx(\"strong\", null, product.business))), __jsx(\"li\", null, \"- Ubicaci\\xF3n: \", __jsx(\"span\", {\n    className: \"text-dark\"\n  }, __jsx(\"strong\", null, product.location)))), __jsx(\"hr\", null), __jsx(\"p\", null, product.description))), __jsx(\"article\", {\n    className: \"col-12 col-sm-12 col-lg-4 col-xl-4\"\n  }, __jsx(\"article\", {\n    className: \"col-12\"\n  }, __jsx(\"h1\", {\n    className: \"component-info-buy\"\n  }, product.title), __jsx(\"h4\", {\n    className: \"text-primary component-info-buy \".concat(userIsNotReffered)\n  }, product.amount !== 0 ? __jsx(CurrencyFormat, {\n    value: product.amount,\n    displayType: 'text',\n    thousandSeparator: true,\n    prefix: '$'\n  }) : __jsx(\"span\", {\n    className: \"text-success\"\n  }, \"GRATIS\")), __jsx(\"h4\", {\n    className: \"text-primary component-info-buy \".concat(influencerTokenNoExist)\n  }, product.amount !== 0 ? __jsx(CurrencyFormat, {\n    value: product.amount,\n    displayType: 'text',\n    thousandSeparator: true,\n    prefix: '$'\n  }) : __jsx(\"span\", {\n    className: \"text-success\"\n  }, \"GRATIS\")), __jsx(\"strike\", {\n    className: influencerTokenExist\n  }, __jsx(\"h5\", {\n    className: \"text-secondary component-info-buy \".concat(product.discount === 0 ? 'd-none' : '')\n  }, __jsx(CurrencyFormat, {\n    value: product.amount * product.discount / 100,\n    displayType: 'text',\n    thousandSeparator: true,\n    prefix: '$'\n  }))), __jsx(\"p\", {\n    className: \"col-12 col-sm-12 col-lg-6 col-xl-6 p-0 m-0\"\n  }, __jsx(\"span\", {\n    className: \"\".concat(!product.shipping ? 'd-none' : 'd-block', \" shipping-open bg-primary text-light\")\n  }, \"Lo recib\\xEDs en tu domicilio\"), __jsx(\"span\", {\n    className: \"shipping-open bg-success text-light d-block\"\n  }, \"Env\\xEDo gratis\"))), __jsx(\"article\", {\n    className: \"col-12\"\n  }, __jsx(\"p\", {\n    className: \"component-info-buy\"\n  }, \"Pag\\xE1 al contado o en cuotas con\", __jsx(\"span\", {\n    className: \"text-primary\"\n  }, \" \", __jsx(\"strong\", null, \"Mercado Pago\"))), __jsx(\"p\", null, __jsx(\"span\", {\n    className: \"bg-primary p-2 text-light\"\n  }, \"Se encuentra en \", __jsx(\"strong\", null, product.location))), __jsx(\"article\", {\n    className: \"col-12 p-1 content-method-buy-steps mb-2 text-dark\"\n  }, __jsx(\"ol\", {\n    type: \"1\"\n  }, __jsx(\"li\", {\n    className: \"p-1\"\n  }, \"Hac\\xE9 click en \", __jsx(\"small\", null, \"\\\"Compralo en un instante!\\\"\")), __jsx(\"li\", {\n    className: \"p-1\"\n  }, \"Hac\\xE9 el pago con Mercado Pago\"), __jsx(\"li\", {\n    className: \"p-1\"\n  }, \"Sacale una foto o screenshot al comprobante de pago\"), __jsx(\"li\", {\n    className: \"p-1\"\n  }, __jsx(\"a\", {\n    href: \"#\",\n    className: \"btn btn-success\"\n  }, \"Env\\xEDalo por WhatsApp!\")))), __jsx(\"article\", {\n    className: \"col-12 accept-payment \".concat(acceptPaymentSwitch)\n  }, __jsx(\"article\", {\n    className: \"content--btn-payment p-5 \".concat(acceptPaymentSwitch)\n  }, __jsx(\"article\", {\n    className: \"btn-content\"\n  }, __jsx(\"p\", {\n    className: \"\".concat(acceptPaymentSwitch)\n  }, \"Finaliza tu pago, y te lo enviamos a tu casa!\"), __jsx(\"a\", {\n    href: product.payment,\n    onClick: handlerTransaction,\n    target: \"_blank\",\n    className: \"btn btn-primary text-light d-block \".concat(acceptPaymentSwitch)\n  }, \"Pagar con Mercado Pago!\"), __jsx(\"p\", {\n    className: \"mt-4 \".concat(switchNextStepPayment)\n  }, \"Est\\xE1s a un paso de finalizar tu compra!\", __jsx(\"br\", null), \"Env\\xEDa una foto del comprobante \", __jsx(\"a\", {\n    href: \"#\",\n    className: \"btn btn-success\"\n  }, \"Env\\xEDalo por WhatsApp!\"))))), __jsx(\"input\", {\n    onClick: handlerAcceptPaymentSwitch,\n    type: \"button\",\n    className: \"btn btn-buy-now text-light d-block col-12\",\n    value: valueBtnSwitchPayment\n  })))));\n};\n\nexport default Product;","map":null,"metadata":{},"sourceType":"module"}